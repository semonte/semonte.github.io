<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="chrome=1">
	<title>Builder Pattern</title>

	<link rel="stylesheet" href="/stylesheets/styles.css">
	<link rel="stylesheet" href="/stylesheets/pygment_trac.css">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<!--[if lt IE 9]>
		<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->
	</head>
	<body>
		<div class="wrapper post">
      <div class="top-nav">
        <ul>
          <li><a href="/">Home</a></li>
          <li><a href="/snippets">Snippets</a></li>
          <li><a href="/design-patterns">Design Patterns</a></li>
        </ul>
      </div>
<section class="post">
	<h1>Builder Pattern</h1><p>I use builder pattern quite a lot. Have a search query you want to build? Object that has plenty of fields with some of them mandatatory? Builder pattern is here to save you!</p><p>The idea of the builder pattern is to gradually construct an object without using the object's constructor directly, but with a separate builder object. By using the builder object we can avoid having numerous constructors for an object. We also can make sure that the created object is in a consistent state. Let's see how this works by an example.</p><h2>Use Case</h2><p>I need an employee object that contains basic information about the employee. The employee has fields both <b>mandatory</b> and <b>optional</b>. How do I make sure that my employee class is <b>always</b> in a consistent state with all necessary fields populated?</p><p>The following code contains a sample of the "Employee" class. The object has private fields with setters and getters provided.</p><h3>Employee.java</h3><div class='highlight'><pre><code class='java'><span class='kd'>public</span> <span class='kd'>class</span> <span class='nc'>Employee</span> <span class='o'>{</span>

    <span class='kd'>private</span> <span class='n'>String</span> <span class='n'>firstName</span><span class='o'>;</span>           <span class='c1'>// Required</span>
    <span class='kd'>private</span> <span class='n'>String</span> <span class='n'>lastName</span><span class='o'>;</span>            <span class='c1'>// Required</span>
    <span class='kd'>private</span> <span class='n'>BigDecimal</span> <span class='n'>salaryPerMonth</span><span class='o'>;</span>  <span class='c1'>// Required</span>
    <span class='kd'>private</span> <span class='n'>String</span> <span class='n'>jobTitle</span><span class='o'>;</span>            <span class='c1'>// Optional</span>
    
    <span class='c1'>// getters and setters</span>
    
</code></pre></div><p>If we were to handle the employee object, we would first need to check that it is in a consistent state. So we would always do the following checks when handling an employee object</p><div class='highlight'><pre><code class='java'><span class='k'>if</span><span class='o'>(</span><span class='n'>employee</span><span class='o'>.</span><span class='na'>getFirstName</span><span class='o'>()</span> <span class='o'>!=</span> <span class='kc'>null</span><span class='o'>)</span> <span class='o'>{</span>
  <span class='o'>...</span>
<span class='o'>}</span>
</code></pre></div><h2>Solution</h2><p>There is an easier way! Check out the new improved Employee.java</p><div class='highlight'><pre><code class='java'><span class='kd'>public</span> <span class='kd'>class</span> <span class='nc'>Employee</span> <span class='o'>{</span>

    <span class='kd'>private</span> <span class='n'>String</span> <span class='n'>firstName</span><span class='o'>;</span>           <span class='c1'>// Required</span>
    <span class='kd'>private</span> <span class='n'>String</span> <span class='n'>lastName</span><span class='o'>;</span>            <span class='c1'>// Required</span>
    <span class='kd'>private</span> <span class='n'>BigDecimal</span> <span class='n'>salaryPerMonth</span><span class='o'>;</span>  <span class='c1'>// Required</span>
    <span class='kd'>private</span> <span class='n'>String</span> <span class='n'>jobTitle</span><span class='o'>;</span>            <span class='c1'>// Optional</span>

    <span class='kd'>private</span> <span class='nf'>Employee</span><span class='o'>(</span><span class='n'>EmployeeBuilder</span> <span class='n'>employeeBuilder</span><span class='o'>)</span> <span class='o'>{</span>
        <span class='k'>this</span><span class='o'>.</span><span class='na'>firstName</span> <span class='o'>=</span> <span class='n'>employeeBuilder</span><span class='o'>.</span><span class='na'>firstName</span><span class='o'>;</span>
        <span class='k'>this</span><span class='o'>.</span><span class='na'>lastName</span> <span class='o'>=</span> <span class='n'>employeeBuilder</span><span class='o'>.</span><span class='na'>lastName</span><span class='o'>;</span>
        <span class='k'>this</span><span class='o'>.</span><span class='na'>salaryPerMonth</span> <span class='o'>=</span> <span class='n'>employeeBuilder</span><span class='o'>.</span><span class='na'>salaryPerMonth</span><span class='o'>;</span>
        <span class='k'>this</span><span class='o'>.</span><span class='na'>jobTitle</span> <span class='o'>=</span> <span class='n'>employeeBuilder</span><span class='o'>.</span><span class='na'>jobTitle</span><span class='o'>;</span>
    <span class='o'>}</span>

    <span class='kd'>public</span> <span class='n'>String</span> <span class='nf'>getFirstName</span><span class='o'>()</span> <span class='o'>{</span>
        <span class='k'>return</span> <span class='n'>firstName</span><span class='o'>;</span>
    <span class='o'>}</span>

    <span class='kd'>public</span> <span class='n'>String</span> <span class='nf'>getLastName</span><span class='o'>()</span> <span class='o'>{</span>
        <span class='k'>return</span> <span class='n'>lastName</span><span class='o'>;</span>
    <span class='o'>}</span>

    <span class='kd'>public</span> <span class='n'>BigDecimal</span> <span class='nf'>getSalaryPerMonth</span><span class='o'>()</span> <span class='o'>{</span>
        <span class='k'>return</span> <span class='n'>salaryPerMonth</span><span class='o'>;</span>
    <span class='o'>}</span>

    <span class='kd'>public</span> <span class='n'>String</span> <span class='nf'>getJobTitle</span><span class='o'>()</span> <span class='o'>{</span>
        <span class='k'>return</span> <span class='n'>jobTitle</span><span class='o'>;</span>
    <span class='o'>}</span>

    <span class='kd'>public</span> <span class='kd'>static</span> <span class='kd'>class</span> <span class='nc'>EmployeeBuilder</span> <span class='o'>{</span>
        <span class='kd'>private</span> <span class='n'>String</span> <span class='n'>firstName</span><span class='o'>;</span>
        <span class='kd'>private</span> <span class='n'>String</span> <span class='n'>lastName</span><span class='o'>;</span>
        <span class='kd'>private</span> <span class='n'>BigDecimal</span> <span class='n'>salaryPerMonth</span><span class='o'>;</span>
        <span class='kd'>private</span> <span class='n'>String</span> <span class='n'>jobTitle</span><span class='o'>;</span>

        <span class='kd'>public</span> <span class='n'>EmployeeBuilder</span> <span class='nf'>firstName</span><span class='o'>(</span><span class='n'>String</span> <span class='n'>firstName</span><span class='o'>)</span> <span class='o'>{</span>
            <span class='k'>this</span><span class='o'>.</span><span class='na'>firstName</span> <span class='o'>=</span> <span class='n'>firstName</span><span class='o'>;</span>
            <span class='k'>return</span> <span class='k'>this</span><span class='o'>;</span>
        <span class='o'>}</span>

        <span class='kd'>public</span> <span class='n'>EmployeeBuilder</span> <span class='nf'>lastName</span><span class='o'>(</span><span class='n'>String</span> <span class='n'>lastName</span><span class='o'>)</span> <span class='o'>{</span>
            <span class='k'>this</span><span class='o'>.</span><span class='na'>lastName</span> <span class='o'>=</span> <span class='n'>lastName</span><span class='o'>;</span>
            <span class='k'>return</span> <span class='k'>this</span><span class='o'>;</span>
        <span class='o'>}</span>

        <span class='kd'>public</span> <span class='n'>EmployeeBuilder</span> <span class='nf'>salaryPerMonth</span><span class='o'>(</span><span class='n'>BigDecimal</span> <span class='n'>salaryPerMonth</span><span class='o'>)</span> <span class='o'>{</span>
            <span class='k'>this</span><span class='o'>.</span><span class='na'>salaryPerMonth</span> <span class='o'>=</span> <span class='n'>salaryPerMonth</span><span class='o'>;</span>
            <span class='k'>return</span> <span class='k'>this</span><span class='o'>;</span>
        <span class='o'>}</span>

        <span class='kd'>public</span> <span class='n'>EmployeeBuilder</span> <span class='nf'>jobTitle</span><span class='o'>(</span><span class='n'>String</span> <span class='n'>jobTitle</span><span class='o'>)</span> <span class='o'>{</span>
            <span class='k'>this</span><span class='o'>.</span><span class='na'>jobTitle</span> <span class='o'>=</span> <span class='n'>jobTitle</span><span class='o'>;</span>
            <span class='k'>return</span> <span class='k'>this</span><span class='o'>;</span>
        <span class='o'>}</span>

        <span class='kd'>public</span> <span class='n'>Employee</span> <span class='nf'>build</span><span class='o'>()</span> <span class='o'>{</span>

            <span class='n'>Employee</span> <span class='n'>employee</span> <span class='o'>=</span> <span class='k'>new</span> <span class='n'>Employee</span><span class='o'>(</span><span class='k'>this</span><span class='o'>);</span>

            <span class='k'>if</span> <span class='o'>(</span><span class='n'>employee</span><span class='o'>.</span><span class='na'>getFirstName</span><span class='o'>()</span> <span class='o'>==</span> <span class='kc'>null</span><span class='o'>)</span> <span class='o'>{</span>
                <span class='k'>throw</span> <span class='k'>new</span> <span class='nf'>IllegalStateException</span><span class='o'>(</span><span class='s'>&quot;First name is null!&quot;</span><span class='o'>);</span>
            <span class='o'>}</span>

            <span class='k'>if</span> <span class='o'>(</span><span class='n'>employee</span><span class='o'>.</span><span class='na'>getLastName</span><span class='o'>()</span> <span class='o'>==</span> <span class='kc'>null</span><span class='o'>)</span> <span class='o'>{</span>
                <span class='k'>throw</span> <span class='k'>new</span> <span class='nf'>IllegalStateException</span><span class='o'>(</span><span class='s'>&quot;Last name is null!&quot;</span><span class='o'>);</span>
            <span class='o'>}</span>

            <span class='k'>if</span> <span class='o'>(</span><span class='n'>employee</span><span class='o'>.</span><span class='na'>getSalaryPerMonth</span><span class='o'>()</span> <span class='o'>==</span> <span class='kc'>null</span><span class='o'>)</span> <span class='o'>{</span>
                <span class='k'>throw</span> <span class='k'>new</span> <span class='nf'>IllegalStateException</span><span class='o'>(</span><span class='s'>&quot;Salary per month is null!&quot;</span><span class='o'>);</span>
            <span class='o'>}</span>

            <span class='k'>return</span> <span class='n'>employee</span><span class='o'>;</span>
        <span class='o'>}</span>
    <span class='o'>}</span>
<span class='o'>}</span>
</code></pre></div><p>What have we done? Well, we've used a builder object "EmployeeBuilder" that will construct an immutable "Employee" object with all mandatory fields guaranteed to be populated. The cool thing about this pattern is also the way you construct new objects.</p><div class='highlight'><pre><code class='java'><span class='n'>Employee</span> <span class='n'>employee</span> <span class='o'>=</span> <span class='k'>new</span> <span class='n'>Employee</span><span class='o'>.</span><span class='na'>EmployeeBuilder</span><span class='o'>()</span>
        <span class='o'>.</span><span class='na'>firstName</span><span class='o'>(</span><span class='s'>&quot;Sebastian&quot;</span><span class='o'>)</span>
        <span class='o'>.</span><span class='na'>lastName</span><span class='o'>(</span><span class='s'>&quot;Monte&quot;</span><span class='o'>)</span>
        <span class='o'>.</span><span class='na'>jobTitle</span><span class='o'>(</span><span class='s'>&quot;Developer&quot;</span><span class='o'>)</span>
        <span class='o'>.</span><span class='na'>salaryPerMonth</span><span class='o'>(</span><span class='k'>new</span> <span class='n'>BigDecimal</span><span class='o'>(</span><span class='mi'>0</span><span class='o'>))</span>
        <span class='o'>.</span><span class='na'>build</span><span class='o'>();</span>
        
</code></pre></div><p>If you miss a mandatory field, the object will not be created and you'll be greeted with an "IllegalStateException" :)</p>
</section>
  </div>
	<script src="javascripts/scale.fix.js"></script>

</body>
</html>